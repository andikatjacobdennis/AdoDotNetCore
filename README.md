# ADO.Net

![.NET](https://img.shields.io/badge/.NET-9.0-blue)
![SQL Server](https://img.shields.io/badge/SQL_Server-2022-green)
![License](https://img.shields.io/badge/license-MIT-green)
[![.NET 9 Build](https://github.com/andikatjacobdennis/AdoNetDemo/actions/workflows/dotnet-desktop.yml/badge.svg)](https://github.com/andikatjacobdennis/AdoNetDemo/actions/workflows/dotnet-desktop.yml)

A simple .NET console application demonstrating various database operations using **ADO.NET** with SQL Server. This project serves as a practical guide to the core functionalities and best practices of ADO.NET, including both connected and disconnected architectures.

-----

## Table of Contents

  - [Prerequisites](https://www.google.com/search?q=%23prerequisites)
  - [Setup](https://www.google.com/search?q=%23setup)
  - [Build and Run](https://www.google.com/search?q=%23build-and-run)
  - [Project Structure](https://www.google.com/search?q=%23project-structure)
  - [Notes](https://www.google.com/search?q=%23notes)
  - [Contributing](https://www.google.com/search?q=%23contributing)
  - [License](https://www.google.com/search?q=%23license)

-----

## Prerequisites

  - [.NET 9.0 SDK](https://dotnet.microsoft.com/en-us/download) or later installed
  - SQL Server instance (2022 or later recommended)
  - Basic knowledge of C\# and SQL
  - **For Microsoft Access connectivity:** You must install the **Microsoft Access Database Engine 2016 Redistributable**. Download the `accessdatabaseengine_X64.exe` installer from the official Microsoft website and install it. This provides the necessary OLE DB driver for `OleDbConnection`.

-----

## Setup

1.  Create the database and tables in SQL Server using the provided script:

<!-- end list -->

```sql
-- Create Database if it doesn't exist
IF NOT EXISTS (SELECT name FROM sys.databases WHERE name = 'AdoNetTrainingDB')
BEGIN
    CREATE DATABASE AdoNetTrainingDB;
    PRINT 'Database AdoNetTrainingDB created.';
END
ELSE
BEGIN
    PRINT 'Database AdoNetTrainingDB already exists.';
END
GO

USE AdoNetTrainingDB;
GO

-- Create Table: YourTable
IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='YourTable' AND xtype='U')
BEGIN
    CREATE TABLE YourTable (
        Id INT IDENTITY(1,1) PRIMARY KEY,
        Name NVARCHAR(100) NOT NULL
    );
    PRINT 'Table YourTable created.';
END
ELSE
BEGIN
    PRINT 'Table YourTable already exists.';
END
GO

-- Create Table: LargeTable
IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='LargeTable' AND xtype='U')
BEGIN
    CREATE TABLE LargeTable (
        Id INT IDENTITY(1,1) PRIMARY KEY,
        DataValue NVARCHAR(255) NOT NULL
    );
    PRINT 'Table LargeTable created.';
END
ELSE
BEGIN
    PRINT 'Table LargeTable already exists.';
END
GO

-- Insert Sample Data into YourTable only if empty
IF NOT EXISTS (SELECT 1 FROM YourTable)
BEGIN
    INSERT INTO YourTable (Name) VALUES
    ('Alice'),
    ('Bob'),
    ('Charlie'),
    ('David'),
    ('Eva');
    PRINT 'Sample data inserted into YourTable.';
END
ELSE
BEGIN
    PRINT 'YourTable already has data.';
END
GO

-- Insert Bulk Data into LargeTable only if empty
IF NOT EXISTS (SELECT 1 FROM LargeTable)
BEGIN
    DECLARE @i INT = 1;
    WHILE @i <= 1000
    BEGIN
        INSERT INTO LargeTable (DataValue) VALUES ('Value ' + CAST(@i AS NVARCHAR(10)));
        SET @i += 1;
    END
    PRINT 'Sample bulk data inserted into LargeTable.';
END
ELSE
BEGIN
    PRINT 'LargeTable already has data.';
END
GO

-- Create Stored Procedure if it doesn't exist
IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='MyStoredProc' AND xtype='P')
BEGIN
    EXEC('
    CREATE PROCEDURE MyStoredProc
        @Param1 NVARCHAR(100)
    AS
    BEGIN
        SET NOCOUNT ON;
        INSERT INTO YourTable (Name) VALUES (@Param1);
        SELECT ''Inserted '' + @Param1 AS ResultMessage;
    END
    ');
    PRINT 'Stored procedure MyStoredProc created.';
END
ELSE
BEGIN
    PRINT 'Stored procedure MyStoredProc already exists.';
END
GO
```

-----

## Build and Run

From the project directory:

```bash
dotnet build
dotnet run
```

-----

## Project Structure

  * `Program.cs` — The main program that demonstrates ADO.NET concepts through a console menu.
  * `AdoNetDemo.csproj` — The project file, which includes necessary NuGet package references.
  * `SampleAccessDB.accdb` — (Optional) A sample Microsoft Access database used for demonstrating OLE DB connections.
  * `people.xml` and `people.json` — (Optional) Files generated by the program to show data serialization.

-----

## Notes

### ADO.NET Concepts

This project covers the foundational concepts of ADO.NET, a low-level, high-performance technology for data access in .NET that gives you direct control over database interactions.

#### 1\. Connected vs. Disconnected Architecture

The two primary approaches in ADO.NET are **connected** and **disconnected**.

  * **Connected Architecture:** Maintains an open connection to the database while data is being read. This approach, using objects like `SqlConnection` and `SqlDataReader`, is fast and memory-efficient for read-only, forward-only access of large datasets.
  * **Disconnected Architecture:** Fetches data into a local, in-memory **`DataSet`** and then closes the connection. The application can work with this offline data and later use a `SqlDataAdapter` to push changes back to the database. This is great for caching and working with multiple related tables.

#### 2\. Key Classes

  * **`SqlConnection`**: Manages the connection to a SQL Server database using a specified connection string.
  * **`SqlCommand`**: Represents a SQL statement or stored procedure to be executed.
  * **`SqlDataReader`**: An efficient, read-only, forward-only stream for reading rows from a database.
  * **`SqlDataAdapter`**: Acts as a bridge between the `DataSet` and the database. It fills the `DataSet` with data and pushes changes back to the database.
  * **`DataSet` and `DataTable`**: A `DataSet` is an in-memory representation of database data, acting like a lightweight database. It contains one or more `DataTable` objects, which represent individual tables.

#### 3\. Security and Best Practices

  * **Parameterized Commands**: The project demonstrates how to use **parameterized queries** to prevent **SQL injection** attacks. Instead of concatenating user input directly into a SQL string, you use placeholders (e.g., `@name`) to separate the command logic from the data.
  * **Transactions**: The code shows how to use **transactions** (`SqlTransaction`) to group multiple operations into an atomic unit. This ensures that either all operations succeed (`Commit`) or all are undone (`Rollback`), preserving data integrity.
  * **`SqlCommandBuilder`**: This utility can automatically generate the necessary `INSERT`, `UPDATE`, and `DELETE` commands for a `DataAdapter`, which simplifies development for disconnected updates.
  * **`SqlBulkCopy`**: The fastest way to insert a large amount of data into a SQL Server table. It bypasses individual row insertions for a more efficient bulk operation.

-----

## Contributing

Contributions are welcome\! Please follow these steps:

1.  Fork the repository.
2.  Create a new feature branch (`git checkout -b feature/YourFeature`).
3.  Commit your changes (`git commit -m "Add feature"`).
4.  Push to your branch (`git push origin feature/YourFeature`).
5.  Open a Pull Request for review.

Please ensure your code follows existing style conventions and includes tests where appropriate.

-----

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE.md) file for details.

-----

*Made with ❤️ for developers exploring ADO.NET and .NET Core.*